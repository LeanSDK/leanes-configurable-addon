"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function r(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o(e,t)}function n(e){return(n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?a(e):t}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,i=n(e);if(t){var o=n(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return c(this,r)}}function l(e,t,r){return(l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=n(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function f(e,t,r,i){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}function p(e,t,r,i,n){var o={};return Object.keys(i).forEach((function(e){o[e]=i[e]})),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=r.slice().reverse().reduce((function(r,i){return i(e,t,r)||r}),o),n&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(n):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}var s={}.hasOwnProperty,y={}.hasOwnProperty;module.exports=function(t){var o=t.NS,c=o.initializeMixin,b=o.meta,g=o.constant,d=o.extend;return["ConfigurableAddon",function(t){var o,h,O,v,m,w;return d("ConfigurableFacadeMixin","Facade")(o=function(t){var o=t.NS,a=o.CONFIGURATION,c=o.initializeMixin,f=o.meta,s=o.method;o.Utils._,t.defineMixin("/mixins/ConfigurableFacadeMixin.js",(function(t){var o,y,b,g,d;return c((d=g=function(t){i(c,t);var o=u(c);function c(){return e(this,c),o.apply(this,arguments)}return r(c,[{key:"initializeFacade",value:function(){l(n(c.prototype),"initializeFacade",this).apply(this,arguments),this.addProxy(a,"Configuration",this.Module.NS.ROOT)}}]),c}(t),g.object={},p(y=d,"object",[f],(b=(b=Object.getOwnPropertyDescriptor(y,"object"))?b.value:void 0,{enumerable:!0,configurable:!0,writable:!0,initializer:function(){return b}}),y),p(y.prototype,"initializeFacade",[s],Object.getOwnPropertyDescriptor(y.prototype,"initializeFacade"),y.prototype),o=y))||o}))}(o=function(t){var n=t.NS,o=n.assert,a=n.initializeMixin,c=n.meta,l=n.property,f=n.method,s=n.Utils,b=s._,g=s.assign;t.defineMixin("/mixins/MemoryConfigurationMixin.js",(function(t){var n,s,d,h,O;return a((O=h=function(t){i(a,t);var n=u(a);function a(){return e(this,a),n.apply(this,arguments)}return r(a,[{key:"defineConfigProperties",value:function(){var e=this,t="".concat(this.root,"/").concat(this.manifestPath),r=this.ApplicationModule.require(t);this._name=r.name,this._description=r.description,this._license=r.license,this._version=r.version,this._keywords=r.keywords;var i=r.configuration,n=g({},i,this.getData());for(var a in n)y.call(n,a)&&function(t,r){switch(o(null!=r.description,"Description in config definition is required"),o(!r.required||null!=r.default,"Attribute '".concat(t,"' is required in config")),o(null!=r.type,"Type in config definition is required"),r.type){case"string":o(b.isString(r.default),"Default for '".concat(t,"' must be string"));break;case"number":o(b.isNumber(r.default),"Default for '".concat(t,"' must be number"));break;case"boolean":o(b.isBoolean(r.default),"Default for '".concat(t,"' must be boolean"));break;case"integer":o(b.isInteger(r.default),"Default for '".concat(t,"' must be integer"));break;case"json":o(b.isString(r.default),"Default for '".concat(t,"' must be JSON string"));try{JSON.parse(r.default)}catch(e){o.fail("Default for '".concat(t,"' is not valid JSON"))}break;case"password":o(b.isString(r.default),"Default for '".concat(t,"' must be string"))}Reflect.defineProperty(e,t,{enumerable:!0,configurable:!0,writable:!1,value:r.default})}(a,n[a])}},{key:"root",get:function(){return this.Module.prototype.ROOT||"."}}]),a}(t),h.object={},p(s=O,"object",[c],(d=(d=Object.getOwnPropertyDescriptor(s,"object"))?d.value:void 0,{enumerable:!0,configurable:!0,writable:!0,initializer:function(){return d}}),s),p(s.prototype,"root",[l],Object.getOwnPropertyDescriptor(s.prototype,"root"),s.prototype),p(s.prototype,"defineConfigProperties",[f],Object.getOwnPropertyDescriptor(s.prototype,"defineConfigProperties"),s.prototype),n=s))||n}))}(o=function(t){var n=t.NS,o=n.CONFIGURATION,c=n.initializeMixin,l=n.meta,s=n.property,y=n.inject;t.defineMixin("/mixins/ConfigurableMixin.js",(function(t){var n,b,g,d,h,O,v,m;return n=y("Factory<".concat(o,">")),c((m=v=function(t){i(o,t);var n=u(o);function o(){var t;e(this,o);for(var r=arguments.length,i=new Array(r),c=0;c<r;c++)i[c]=arguments[c];return f(t=n.call.apply(n,[this].concat(i)),"_configurableI",h,a(t)),f(t,"_configurationFactory",O,a(t)),t}return r(o,[{key:"configs",get:function(){return this._configurationFactory()}}]),o}(t),v.object={},p(g=m,"object",[l],(d=(d=Object.getOwnPropertyDescriptor(g,"object"))?d.value:void 0,{enumerable:!0,configurable:!0,writable:!0,initializer:function(){return d}}),g),h=p(g.prototype,"_configurableI",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"ConfigurableInterface"}}),O=p(g.prototype,"_configurationFactory",[n,s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p(g.prototype,"configs",[s],Object.getOwnPropertyDescriptor(g.prototype,"configs"),g.prototype),b=g))||b}))}(o=function(t){var o,c,y,b,g,d,h,O,v,m,w,j,P=t.NS,_=P.PRODUCTION,D=P.DEVELOPMENT,k=P.ENV,z=P.Proxy,N=P.assert,C=P.initialize,S=P.partOf,x=P.meta,R=P.property,M=P.method,I=P.nameBy,F=P.Utils,A=F._,T=F.assign;C(o=S(t)((j=w=function(t){i(c,t);var o=u(c);function c(){var t;e(this,c);for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return f(t=o.call.apply(o,[this].concat(i)),"_configI",g,a(t)),f(t,"_name",d,a(t)),f(t,"_description",h,a(t)),f(t,"_license",O,a(t)),f(t,"_version",v,a(t)),f(t,"_keywords",m,a(t)),t}return r(c,[{key:"defineConfigProperties",value:function(){var e=this,t="".concat(this.root,"/").concat(this.manifestPath),r=this.ApplicationModule.require(t);this._name=r.name,this._description=r.description,this._license=r.license,this._version=r.version,this._keywords=r.keywords;var i=r.configuration,n="".concat(this.root,"/").concat(this.configPath),o=this.ApplicationModule.require(n),a=T({},i,o);for(var c in a)s.call(a,c)&&function(t,r){switch(N(null!=r.description,"Description in config definition is required"),N(!r.required||null!=r.default,"Attribute '".concat(t,"' is required in config")),N(null!=r.type,"Type in config definition is required"),r.type){case"string":N(A.isString(r.default),"Default for '".concat(t,"' must be string"));break;case"number":N(A.isNumber(r.default),"Default for '".concat(t,"' must be number"));break;case"boolean":N(A.isBoolean(r.default),"Default for '".concat(t,"' must be boolean"));break;case"integer":N(A.isInteger(r.default),"Default for '".concat(t,"' must be integer"));break;case"json":N(A.isString(r.default)||A.isPlainObject(r.default),"Default for '".concat(t,"' must be JSON string or js object"));try{A.isString(r.default)&&JSON.parse(r.default)}catch(e){N.fail("Default for '".concat(t,"' is not valid JSON"))}break;case"password":N(A.isString(r.default),"Default for '".concat(t,"' must be string"))}Reflect.defineProperty(e,t,{enumerable:!0,configurable:!0,writable:!1,value:"json"===r.type&&A.isString(r.default)?JSON.parse(r.default):r.default})}(c,a[c])}},{key:"onRegister",value:function(){for(var e,t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];(e=l(n(c.prototype),"onRegister",this)).call.apply(e,[this].concat(r)),this.defineConfigProperties()}},{key:"root",get:function(){return this.getData()||"."}},{key:"environment",get:function(){return"production"===k?_:D}},{key:"name",get:function(){return this._name}},{key:"description",get:function(){return this._description}},{key:"license",get:function(){return this._license}},{key:"version",get:function(){return this._version}},{key:"keywords",get:function(){return this._keywords}},{key:"manifestPath",get:function(){return"package.json"}},{key:"configPath",get:function(){return"configs/".concat(this.environment)}}]),c}(z),w.__filename="/proxies/Configuration.js",w.object={},p(c=j,"__filename",[I],(y=(y=Object.getOwnPropertyDescriptor(c,"__filename"))?y.value:void 0,{enumerable:!0,configurable:!0,writable:!0,initializer:function(){return y}}),c),p(c,"object",[x],(b=(b=Object.getOwnPropertyDescriptor(c,"object"))?b.value:void 0,{enumerable:!0,configurable:!0,writable:!0,initializer:function(){return b}}),c),g=p(c.prototype,"_configI",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"ConfigurationInterface"}}),p(c.prototype,"root",[R],Object.getOwnPropertyDescriptor(c.prototype,"root"),c.prototype),p(c.prototype,"environment",[R],Object.getOwnPropertyDescriptor(c.prototype,"environment"),c.prototype),d=p(c.prototype,"_name",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),h=p(c.prototype,"_description",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=p(c.prototype,"_license",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=p(c.prototype,"_version",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),m=p(c.prototype,"_keywords",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),p(c.prototype,"name",[R],Object.getOwnPropertyDescriptor(c.prototype,"name"),c.prototype),p(c.prototype,"description",[R],Object.getOwnPropertyDescriptor(c.prototype,"description"),c.prototype),p(c.prototype,"license",[R],Object.getOwnPropertyDescriptor(c.prototype,"license"),c.prototype),p(c.prototype,"version",[R],Object.getOwnPropertyDescriptor(c.prototype,"version"),c.prototype),p(c.prototype,"keywords",[R],Object.getOwnPropertyDescriptor(c.prototype,"keywords"),c.prototype),p(c.prototype,"manifestPath",[R],Object.getOwnPropertyDescriptor(c.prototype,"manifestPath"),c.prototype),p(c.prototype,"configPath",[R],Object.getOwnPropertyDescriptor(c.prototype,"configPath"),c.prototype),p(c.prototype,"defineConfigProperties",[M],Object.getOwnPropertyDescriptor(c.prototype,"defineConfigProperties"),c.prototype),p(c.prototype,"onRegister",[M],Object.getOwnPropertyDescriptor(c.prototype,"onRegister"),c.prototype),o=c))||o)}(o=c((w=m=function(t){i(n,t);var r=u(n);function n(){var t;e(this,n);for(var i=arguments.length,o=new Array(i),c=0;c<i;c++)o[c]=arguments[c];return f(t=r.call.apply(r,[this].concat(o)),"CONFIGURATION",v,a(t)),t}return n}(t),m.object={},p(h=w,"object",[b],(O=(O=Object.getOwnPropertyDescriptor(h,"object"))?O.value:void 0,{enumerable:!0,configurable:!0,writable:!0,initializer:function(){return O}}),h),v=p(h.prototype,"CONFIGURATION",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"ConfigurationProxy"}}),o=h))||o)||o)||o)||o)||o)||o}]};
